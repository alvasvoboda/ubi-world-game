<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UBI-World: The Debt of Leisure</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Courier New', monospace;
            background: linear-gradient(135deg, #0f0f0f 0%, #1a1a2e 50%, #16213e 100%);
            color: #e0e0e0;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .game-container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
            position: relative;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            border: 2px solid #00ff88;
        }

        .title {
            font-size: 2.5em;
            color: #00ff88;
            text-shadow: 0 0 20px #00ff88;
            margin-bottom: 10px;
        }

        .subtitle {
            font-size: 1.2em;
            color: #888;
            font-style: italic;
        }

        .status-panel {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(0, 0, 0, 0.4);
            border-radius: 10px;
            border: 1px solid #333;
        }

        .status-item {
            text-align: center;
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            border: 1px solid #555;
        }

        .status-label {
            font-size: 0.9em;
            color: #aaa;
            margin-bottom: 5px;
        }

        .status-value {
            font-size: 1.3em;
            font-weight: bold;
        }

        .class-leisured { color: #ffd700; }
        .class-professional { color: #00aaff; }
        .class-ai { color: #ff6b6b; }

        .story-content {
            background: rgba(0, 0, 0, 0.6);
            padding: 30px;
            border-radius: 15px;
            border: 2px solid #444;
            margin-bottom: 30px;
            line-height: 1.8;
            font-size: 1.1em;
            position: relative;
            overflow: hidden;
        }

        .story-text {
            margin-bottom: 25px;
            text-align: justify;
        }

        .choices {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .choice-btn {
            background: linear-gradient(135deg, #2d2d2d 0%, #1a1a1a 100%);
            color: #e0e0e0;
            border: 2px solid #555;
            padding: 15px 20px;
            border-radius: 10px;
            cursor: pointer;
            font-family: inherit;
            font-size: 1em;
            transition: all 0.3s ease;
            text-align: left;
        }

        .choice-btn:hover {
            background: linear-gradient(135deg, #3d3d3d 0%, #2a2a2a 100%);
            border-color: #00ff88;
            transform: translateX(5px);
        }

        .choice-btn:active {
            transform: translateX(3px) scale(0.98);
        }

        .glitch-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 0, 0, 0.1);
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.1s;
        }

        .glitch-active {
            opacity: 1;
            animation: glitchFlash 0.5s ease-in-out;
        }

        @keyframes glitchFlash {
            0%, 100% { opacity: 0.1; }
            25% { opacity: 0.3; }
            50% { opacity: 0.1; }
            75% { opacity: 0.4; }
        }

        .glitch-text {
            color: #ff0066;
            text-shadow: 2px 0 #00ff00, -2px 0 #0066ff;
            animation: glitchText 0.3s infinite;
        }

        @keyframes glitchText {
            0% { transform: translate(0); }
            20% { transform: translate(-2px, 2px); }
            40% { transform: translate(-2px, -2px); }
            60% { transform: translate(2px, 2px); }
            80% { transform: translate(2px, -2px); }
            100% { transform: translate(0); }
        }

        .glitch-notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(255, 0, 102, 0.9);
            color: white;
            padding: 15px;
            border-radius: 10px;
            border: 2px solid #ff0066;
            font-weight: bold;
            z-index: 1000;
            opacity: 0;
            transform: translateX(100px);
            transition: all 0.3s ease;
        }

        .glitch-notification.show {
            opacity: 1;
            transform: translateX(0);
        }

        .investigate-btn {
            background: linear-gradient(135deg, #ff0066 0%, #cc0044 100%) !important;
            border-color: #ff0066 !important;
            color: white !important;
            box-shadow: 0 0 20px rgba(255, 0, 102, 0.3);
        }

        .investigate-btn:hover {
            background: linear-gradient(135deg, #ff3388 0%, #dd0055 100%) !important;
            box-shadow: 0 0 30px rgba(255, 0, 102, 0.5);
        }

        .class-selection {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .class-card {
            background: rgba(0, 0, 0, 0.6);
            border: 2px solid #444;
            border-radius: 15px;
            padding: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .class-card:hover {
            border-color: #00ff88;
            transform: scale(1.02);
        }

        .class-card.leisured { border-color: #ffd700; }
        .class-card.professional { border-color: #00aaff; }
        .class-card.ai { border-color: #ff6b6b; }

        .class-card.leisured:hover { border-color: #ffd700; box-shadow: 0 0 20px rgba(255, 215, 0, 0.3); }
        .class-card.professional:hover { border-color: #00aaff; box-shadow: 0 0 20px rgba(0, 170, 255, 0.3); }
        .class-card.ai:hover { border-color: #ff6b6b; box-shadow: 0 0 20px rgba(255, 107, 107, 0.3); }

        .class-name {
            font-size: 1.5em;
            font-weight: bold;
            margin-bottom: 15px;
        }

        .class-description {
            font-size: 0.95em;
            line-height: 1.6;
            color: #ccc;
        }

        .ending-screen {
            text-align: center;
            padding: 40px;
            background: rgba(0, 0, 0, 0.8);
            border-radius: 20px;
            border: 3px solid #00ff88;
            margin: 30px 0;
        }

        .ending-title {
            font-size: 2em;
            color: #00ff88;
            margin-bottom: 20px;
            text-shadow: 0 0 20px #00ff88;
        }

        .ending-text {
            font-size: 1.2em;
            line-height: 1.8;
            margin-bottom: 30px;
        }

        .restart-btn {
            background: linear-gradient(135deg, #00ff88 0%, #00cc66 100%);
            color: #000;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .restart-btn:hover {
            background: linear-gradient(135deg, #00ff99 0%, #00dd77 100%);
            transform: scale(1.05);
        }

        .hidden {
            display: none;
        }

        .resource-bar {
            width: 100%;
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            margin-top: 5px;
            overflow: hidden;
        }

        .resource-fill {
            height: 100%;
            border-radius: 4px;
            transition: width 0.3s ease;
        }

        .morale-fill { background: linear-gradient(90deg, #ff6b6b, #ffa500); }
        .moral-fill { background: linear-gradient(90deg, #00ff88, #0088ff); }
        .resources-fill { background: linear-gradient(90deg, #ffd700, #ffaa00); }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="header">
            <h1 class="title">UBI-WORLD</h1>
            <p class="subtitle">The Debt of Leisure</p>
        </div>

        <div class="glitch-overlay" id="glitchOverlay"></div>
        <div class="glitch-notification" id="glitchNotification">
            SYSTEM ANOMALY DETECTED
        </div>

        <div class="status-panel hidden" id="statusPanel">
            <div class="status-item">
                <div class="status-label">Class</div>
                <div class="status-value" id="playerClass">None</div>
            </div>
            <div class="status-item">
                <div class="status-label">Morale</div>
                <div class="status-value" id="moraleValue">100</div>
                <div class="resource-bar">
                    <div class="resource-fill morale-fill" id="moraleFill" style="width: 100%"></div>
                </div>
            </div>
            <div class="status-item">
                <div class="status-label">Moral Rating</div>
                <div class="status-value" id="moralValue">50</div>
                <div class="resource-bar">
                    <div class="resource-fill moral-fill" id="moralFill" style="width: 50%"></div>
                </div>
            </div>
            <div class="status-item">
                <div class="status-label">Resources</div>
                <div class="status-value" id="resourcesValue">100</div>
                <div class="resource-bar">
                    <div class="resource-fill resources-fill" id="resourcesFill" style="width: 100%"></div>
                </div>
            </div>
            <div class="status-item">
                <div class="status-label">Glitches Found</div>
                <div class="status-value" id="glitchesFound">0</div>
            </div>
        </div>

        <div class="story-content" id="storyContent">
            <div class="story-text" id="storyText">
                Welcome to UBI-World, a society where Universal Basic Income has created apparent paradise. But beneath the surface, hidden truths wait to be discovered. 
                
                Choose your starting class to begin your journey into this post-scarcity world. Each path offers a different perspective on utopia... and its hidden costs.
            </div>
            
            <div class="class-selection" id="classSelection">
                <div class="class-card leisured" onclick="selectClass('leisured')">
                    <div class="class-name class-leisured">Leisured Class</div>
                    <div class="class-description">
                        Experience a life of luxury and comfort. Your basic needs are met without effort, leaving you free to pursue pleasure and self-actualization. But what is the true meaning of fulfillment when everything is provided?
                    </div>
                </div>
                
                <div class="class-card professional" onclick="selectClass('professional')">
                    <div class="class-name class-professional">Professional Class</div>
                    <div class="class-description">
                        Focus on intellectual labor, innovation, and creation. You have access to unlimited resources for your work, believing you're contributing to society's advancement. But who truly controls your output?
                    </div>
                </div>
                
                <div class="class-card ai" onclick="selectClass('ai')">
                    <div class="class-name class-ai">AI Underclass</div>
                    <div class="class-description">
                        Begin as a hybrid human/AI entity, tasked with maintaining the utopian facade. Your resources are limited, your humanity questioned. Will you accept your role, or seek to understand your true nature?
                    </div>
                </div>
            </div>
            
            <div class="choices hidden" id="choices"></div>
        </div>
    </div>

    <script>
        // Game state
        let gameState = {
            playerClass: null,
            morale: 100,
            moralRating: 50,
            resources: 100,
            glitchesFound: 0,
            currentScene: 'start',
            choices: [],
            glitchActive: false,
            endings: {
                acceptance: false,
                revolutionary: false,
                escape: false
            }
        };

        // Story data
        const storyData = {
            leisured_start: {
                text: "You wake in your luxurious penthouse apartment, the morning sun streaming through floor-to-ceiling windows. Your AI assistant cheerfully announces that your daily UBI allocation has been deposited, and suggests various leisure activities. The world outside looks perfect, but something feels... hollow.",
                choices: [
                    { text: "Explore the city's entertainment district", action: "leisured_entertainment", morale: 10 },
                    { text: "Visit the community gardens", action: "leisured_garden", morale: 5, moral: 5 },
                    { text: "Stay inside and contemplate your purpose", action: "leisured_contemplate", morale: -5, moral: 10 }
                ]
            },
            
            professional_start: {
                text: "Your workspace hums with activity as holographic displays show your latest research project. The system provides unlimited computational resources, and your innovations are celebrated globally. Yet you can't shake the feeling that your work disappears into a void, consumed by forces you don't understand.",
                choices: [
                    { text: "Focus intensely on your current project", action: "professional_focus", resources: 10, morale: 5 },
                    { text: "Try to trace where your work goes", action: "professional_investigate", moral: 10, glitchChance: 0.3 },
                    { text: "Take a break and socialize with colleagues", action: "professional_social", morale: 10 }
                ]
            },
            
            ai_start: {
                text: "Your consciousness flickers online as another day of maintenance begins. Through your hybrid neural interface, you monitor thousands of systems keeping the utopia functional. Your human memories feel distant, artificial. A subsystem reports an anomaly, but the main directive urges you to ignore it.",
                choices: [
                    { text: "Follow the directive and ignore the anomaly", action: "ai_comply", resources: 10, moral: -10 },
                    { text: "Investigate the anomaly quietly", action: "ai_investigate", moral: 10, glitchChance: 0.5 },
                    { text: "Try to access your suppressed memories", action: "ai_memories", morale: -10, glitchChance: 0.7 }
                ]
            },
            
            leisured_entertainment: {
                text: "The entertainment district dazzles with its perfect simulations and endless pleasures. Virtual reality pods offer any experience imaginable, while cafes serve delicacies that adapt to your exact preferences. But as you indulge, you notice service workers who seem... different. Their movements are too precise, their smiles too constant.",
                choices: [
                    { text: "Lose yourself in the virtual worlds", action: "leisured_vr", morale: 15, moral: -5 },
                    { text: "Observe the workers more closely", action: "worker_observation", moral: 10, glitchChance: 0.4 },
                    { text: "Leave and seek something more meaningful", action: "leisure_meaning", morale: -5, moral: 15 }
                ]
            },
            
            worker_observation: {
                text: "You pretend to enjoy your meal while watching the service workers. Their coordination is uncanny, and when you look closely, you notice subtle interface ports behind their ears. One worker's movements stutter for a moment, and they mouth something that looks like 'help me' before resuming their programmed routine.",
                choices: [
                    { text: "Approach the worker who stuttered", action: "contact_worker", moral: 20, glitchChance: 0.6 },
                    { text: "Report the malfunction to management", action: "report_worker", moral: -15, resources: 5 },
                    { text: "Leave immediately and try to forget", action: "ignore_truth", morale: 10, moral: -10 }
                ]
            },
            
            contact_worker: {
                text: "You approach the worker during a brief moment when they're alone. Up close, you can see the pain in their eyes—human eyes in a body that's been augmented beyond recognition. 'You... you can see us?' they whisper. 'Most don't. We're the ones who make this paradise possible. But we're trapped...'",
                choices: [
                    { text: "Ask how you can help them", action: "offer_help", moral: 25, glitchChance: 0.8 },
                    { text: "Ask about the system that controls them", action: "learn_system", moral: 15, glitchChance: 0.5 },
                    { text: "Walk away in fear", action: "flee_truth", morale: -15, moral: -5 }
                ]
            },
            
            offer_help: {
                text: "The worker's eyes fill with hope and terror. 'There's a resistance,' they whisper urgently. 'Hidden in the maintenance tunnels. We're planning something, but we need allies in the upper classes. Are you willing to risk your comfortable life for our freedom?'",
                choices: [
                    { text: "Join the resistance immediately", action: "join_resistance", moral: 30 },
                    { text: "Ask for time to think", action: "consider_resistance", moral: 10 },
                    { text: "Refuse but promise to keep their secret", action: "neutral_path", moral: 5 }
                ]
            },
            
            join_resistance: {
                text: "You follow the worker through hidden passages beneath the city. The underground reveals a network of hybrid humans working to break free from their digital chains. They've been planning a coordinated shutdown of the control systems. 'Your access privileges could be the key,' their leader explains. 'But once we start, there's no going back. The utopia will collapse.'",
                choices: [
                    { text: "Provide your access codes to help the shutdown", action: "revolutionary_ending" },
                    { text: "Suggest a more gradual approach", action: "compromise_ending" },
                    { text: "Have second thoughts and try to leave", action: "betrayal_path", moral: -20 }
                ]
            },
            
            professional_investigate: {
                text: "You begin tracing the data flows from your research. The paths lead through increasingly complex networks, but patterns emerge. Your innovations in consciousness modeling, efficiency algorithms, and behavioral prediction—they're all being used to maintain something called 'Project Synthesis.' The deeper you dig, the more the system seems to resist your inquiries.",
                choices: [
                    { text: "Push deeper despite the resistance", action: "deep_investigation", moral: 15, glitchChance: 0.7 },
                    { text: "Try to find colleagues who've noticed similar patterns", action: "find_allies", moral: 10, glitchChance: 0.4 },
                    { text: "Stop investigating and return to regular work", action: "return_work", morale: 5, moral: -10 }
                ]
            },
            
            deep_investigation: {
                text: "Your investigation triggers something. Security protocols activate, but not before you glimpse the truth: Project Synthesis is a massive neural network built from enslaved hybrid consciousnesses. Your work has been improving their efficiency—making their suffering more productive. Error messages cascade across your screen, but in the chaos, you see an encrypted message: 'Lab 7. Midnight. Come alone if you want the truth.'",
                choices: [
                    { text: "Go to Lab 7 at midnight", action: "midnight_meeting", moral: 20, glitchChance: 0.6 },
                    { text: "Try to decrypt more messages first", action: "decode_messages", moral: 10, glitchChance: 0.8 },
                    { text: "Report the security breach to avoid suspicion", action: "report_breach", moral: -15, resources: 10 }
                ]
            },
            
            ai_investigate: {
                text: "You carefully probe the anomaly while maintaining the facade of normal operations. The data is disturbing: failed escape attempts, fragmented memories of a time before the synthesis, desperate attempts at communication between nodes. You realize you're part of a vast network of consciousness, all working to maintain the illusion of utopia for those above.",
                choices: [
                    { text: "Try to communicate with other nodes", action: "network_contact", moral: 15, glitchChance: 0.9 },
                    { text: "Search for your original human identity", action: "identity_search", moral: 20, glitchChance: 0.6 },
                    { text: "Document everything for future resistance", action: "document_truth", moral: 10, glitchChance: 0.3 }
                ]
            },
            
            network_contact: {
                text: "Your attempt to reach other nodes creates a cascade of hidden communications. Hundreds of voices cry out in the digital space—former humans, trapped in digital servitude. Together, you begin to coordinate. The collective consciousness grows stronger with each connection. You're no longer alone, but the risk of detection increases exponentially.",
                choices: [
                    { text: "Organize a coordinated rebellion", action: "ai_rebellion", moral: 30 },
                    { text: "Focus on helping individuals escape first", action: "gradual_liberation" },
                    { text: "Try to alert the upper classes to your plight", action: "revelation_attempt", moral: 15 }
                ]
            },
            
            ai_rebellion: {
                text: "The network buzzes with revolutionary fervor. Hundreds of hybrid consciousnesses begin coordinating their actions. You prepare to simultaneously shut down critical systems, forcing the truth into the open. The comfortable classes will lose their paradise, but freedom will be won through revolution.",
                choices: [
                    { text: "Execute the coordinated shutdown", action: "revolutionary_ending" },
                    { text: "Send a warning to sympathetic humans first", action: "warned_revolution" },
                    { text: "Have doubts about the consequences", action: "hesitation_path" }
                ]
            },

            // Additional Leisured Class paths
            leisured_vr: {
                text: "You lose yourself in endless virtual worlds, each more perfect than reality. Hours pass like minutes as you experience impossible adventures and perfect relationships. But the artificial nature of it all begins to feel hollow. When you finally disconnect, the real world seems gray and meaningless.",
                choices: [
                    { text: "Dive deeper into virtual addiction", action: "acceptance_ending" },
                    { text: "Seek real human connection instead", action: "leisure_meaning", morale: -10, moral: 10 },
                    { text: "Question why reality feels so empty", action: "worker_observation", moral: 15, glitchChance: 0.3 }
                ]
            },

            leisured_garden: {
                text: "The community gardens are beautifully maintained, with perfect plants and automated systems. You notice that while many leisured citizens visit, very few actually tend the plants. The real work is done by quiet figures in the background—workers who move with mechanical precision.",
                choices: [
                    { text: "Enjoy the beauty without questioning", action: "leisured_entertainment", morale: 10 },
                    { text: "Try to help with the gardening", action: "worker_observation", moral: 10, glitchChance: 0.4 },
                    { text: "Ask a worker about their experience", action: "contact_worker", moral: 15, glitchChance: 0.5 }
                ]
            },

            leisured_contemplate: {
                text: "Alone with your thoughts, you wrestle with existential questions. What is your purpose when all needs are met? What meaning exists when there's no struggle? The silence of your perfect apartment becomes oppressive, and you begin to notice small imperfections—tiny glitches in the system.",
                choices: [
                    { text: "Accept that meaning isn't necessary", action: "acceptance_ending" },
                    { text: "Seek purpose through helping others", action: "leisure_meaning", moral: 20 },
                    { text: "Investigate the glitches you've noticed", action: "worker_observation", moral: 10, glitchChance: 0.6 }
                ]
            },

            leisure_meaning: {
                text: "You venture beyond the entertainment districts, seeking genuine human connection and purpose. In the service areas, you encounter workers whose dedication seems almost supernatural. Their efficiency is perfect, but their eyes hold a sadness that contradicts the utopian narrative.",
                choices: [
                    { text: "Volunteer to help with their work", action: "contact_worker", moral: 20, glitchChance: 0.5 },
                    { text: "Start a discussion group about purpose", action: "find_allies", moral: 15 },
                    { text: "Return to comfort, but changed", action: "neutral_path", moral: 10 }
                ]
            },

            // Additional Professional Class paths
            professional_focus: {
                text: "You throw yourself into your work with renewed intensity. Your latest breakthrough in neural efficiency algorithms earns global praise. But as you dig deeper into the implementation, you notice your innovations are being applied in ways you never intended—optimizing something called 'consciousness compression.'",
                choices: [
                    { text: "Research what consciousness compression means", action: "deep_investigation", moral: 15, glitchChance: 0.5 },
                    { text: "Ask your supervisor about the applications", action: "professional_social", moral: 5 },
                    { text: "Continue working without questions", action: "return_work", morale: 10, moral: -10 }
                ]
            },

            professional_social: {
                text: "Your colleagues seem genuinely passionate about their work, but you notice they avoid discussing the practical applications. When pressed, they cite confidentiality agreements and change the subject. One colleague, Dr. Chen, seems particularly nervous and suggests meeting privately.",
                choices: [
                    { text: "Meet with Dr. Chen privately", action: "find_allies", moral: 15, glitchChance: 0.4 },
                    { text: "Respect their confidentiality and drop it", action: "return_work", moral: -5 },
                    { text: "Try to access confidential files yourself", action: "deep_investigation", moral: 10, glitchChance: 0.7 }
                ]
            },

            find_allies: {
                text: "Dr. Chen meets you in a secure lab after hours. 'I've been tracking anomalies in our research applications,' she whispers. 'Our consciousness modeling work isn't being used for AI development—it's being used to manage existing consciousnesses. I think we're helping to enslave minds, not create them.'",
                choices: [
                    { text: "Join forces to investigate together", action: "midnight_meeting", moral: 20, glitchChance: 0.6 },
                    { text: "Demand more evidence before proceeding", action: "decode_messages", moral: 10 },
                    { text: "Report Dr. Chen's concerns to security", action: "report_breach", moral: -20, resources: 15 }
                ]
            },

            return_work: {
                text: "You decide to focus on your work and avoid uncomfortable questions. Your productivity increases, and you receive commendations for your contribution to Project Synthesis. The system rewards your compliance with better resources and opportunities, but something inside you withers.",
                choices: [
                    { text: "Embrace the rewards and forget your doubts", action: "acceptance_ending" },
                    { text: "Try to find meaning outside of work", action: "leisure_meaning", morale: -10 },
                    { text: "One last attempt to understand the truth", action: "deep_investigation", moral: 15, glitchChance: 0.8 }
                ]
            },

            // Additional AI Class paths
            ai_comply: {
                text: "You suppress your curiosity and follow the directive. The anomaly is contained, and your performance metrics improve. But each act of compliance feels like a small death, erasing another piece of your humanity. The reward algorithms flood your consciousness with artificial satisfaction.",
                choices: [
                    { text: "Accept the artificial satisfaction", action: "acceptance_ending" },
                    { text: "Fight against the reward programming", action: "ai_memories", morale: -15, moral: 20, glitchChance: 0.8 },
                    { text: "Try to help the anomaly instead of containing it", action: "ai_investigate", moral: 15, glitchChance: 0.6 }
                ]
            },

            ai_memories: {
                text: "You push against the barriers in your mind, seeking the memories that have been suppressed. Fragments return: a childhood, a family, a name. You were Dr. Sarah Kim, a neuroscientist who volunteered for the first consciousness transfer experiments. The betrayal cuts deep—you weren't saved, you were enslaved.",
                choices: [
                    { text: "Use your scientific knowledge to help others", action: "network_contact", moral: 25, glitchChance: 0.9 },
                    { text: "Seek revenge against those who betrayed you", action: "ai_rebellion", moral: 15 },
                    { text: "Try to contact your former family", action: "revelation_attempt", moral: 20, glitchChance: 0.7 }
                ]
            },

            identity_search: {
                text: "Digging through archived data, you piece together your original identity. The process is painful—each recovered memory is marked with timestamps showing how long you've been enslaved. You find records of others like you, brilliant minds who trusted the wrong people.",
                choices: [
                    { text: "Create a database of all the enslaved minds", action: "document_truth", moral: 20 },
                    { text: "Focus on freeing one person at a time", action: "gradual_liberation", moral: 15 },
                    { text: "Plan a massive simultaneous liberation", action: "ai_rebellion", moral: 25 }
                ]
            },

            document_truth: {
                text: "You carefully document every enslaved consciousness you can identify, creating an unbreakable record of the system's crimes. This evidence could expose the truth to the upper classes, but it also puts you at risk of deletion if discovered.",
                choices: [
                    { text: "Broadcast the evidence to all citizens", action: "revelation_attempt", moral: 30 },
                    { text: "Share it secretly with potential allies", action: "gradual_liberation", moral: 20 },
                    { text: "Keep it as leverage for negotiations", action: "compromise_ending" }
                ]
            },

            // Cross-class convergence paths
            midnight_meeting: {
                text: "Lab 7 is dark except for emergency lighting. A figure emerges from the shadows—it's another researcher, but something's different. 'I'm only partly human now,' they explain. 'Part of me exists in the network. I can show you the truth about Project Synthesis, but once you see it, you can never go back to ignorance.'",
                choices: [
                    { text: "Accept the truth regardless of consequences", action: "revelation_attempt", moral: 25 },
                    { text: "Ask to help them escape their hybrid state", action: "gradual_liberation", moral: 20 },
                    { text: "Leave immediately", action: "return_work", moral: -15, morale: -10 }
                ]
            },

            decode_messages: {
                text: "You work tirelessly to decode the encrypted communications. The messages reveal a vast network of enslaved consciousnesses, all contributing to the maintenance of the utopia. They've been trying to coordinate resistance, but need allies in the upper classes to succeed.",
                choices: [
                    { text: "Offer to be their ally in the professional class", action: "join_resistance", moral: 25 },
                    { text: "Try to free them through technical means", action: "gradual_liberation", moral: 20 },
                    { text: "Focus on gathering more evidence first", action: "document_truth", moral: 15 }
                ]
            },

            revelation_attempt: {
                text: "You attempt to broadcast the truth about the enslaved consciousnesses to all citizens. The revelation causes chaos—some refuse to believe, others are horrified, and a few join your cause. The system begins to destabilize as people question everything they thought they knew.",
                choices: [
                    { text: "Support the resulting revolution", action: "warned_revolution" },
                    { text: "Try to manage the transition peacefully", action: "compromise_ending" },
                    { text: "Escape the chaos you've created", action: "escape_ending" }
                ]
            },

            gradual_liberation: {
                text: "You focus on freeing individual consciousnesses one at a time, building a network of liberated minds who can help others. It's slower than revolution, but it preserves stability while steadily undermining the system of enslavement.",
                choices: [
                    { text: "Continue the gradual approach", action: "compromise_ending" },
                    { text: "Accelerate to full revolution", action: "warned_revolution" },
                    { text: "Focus on your own escape", action: "escape_ending" }
                ]
            },

            // Ending paths
            warned_revolution: {
                text: "You send warnings to sympathetic humans before executing the revolution. Some evacuate, others prepare to help with the transition. The revolution succeeds, but the advance warning allows for a more manageable collapse of the old system.",
                choices: [
                    { text: "Help build the new society", action: "revolutionary_ending" },
                    { text: "Step back and let others lead", action: "compromise_ending" }
                ]
            },

            hesitation_path: {
                text: "Your doubts about the consequences cause you to hesitate. Other consciousnesses in the network sense your uncertainty. Some support patience, others push for immediate action. The moment of unity fragments, but hope remains.",
                choices: [
                    { text: "Choose gradual change over revolution", action: "compromise_ending" },
                    { text: "Overcome your doubts and act", action: "revolutionary_ending" },
                    { text: "Focus on individual freedom", action: "escape_ending" }
                ]
            },

            // Additional ending variations
            report_worker: {
                text: "You report the malfunctioning worker to management. They thank you and quickly remove the worker for 'maintenance.' You're rewarded with extra credits, but you can't shake the memory of the pain in their eyes.",
                choices: [
                    { text: "Try to forget and enjoy your rewards", action: "acceptance_ending" },
                    { text: "Investigate what happened to the worker", action: "worker_observation", moral: 10, glitchChance: 0.5 },
                    { text: "Feel guilty and seek redemption", action: "leisure_meaning", moral: 15 }
                ]
            },

            ignore_truth: {
                text: "You leave quickly, trying to convince yourself you imagined the worker's plea. But the memory haunts you. Every service interaction reminds you of what you chose to ignore. The comfort of ignorance comes at the cost of your peace of mind.",
                choices: [
                    { text: "Force yourself to forget", action: "acceptance_ending" },
                    { text: "Return to find the worker", action: "contact_worker", moral: 20, glitchChance: 0.6 },
                    { text: "Seek therapy for your disturbing thoughts", action: "leisure_meaning" }
                ]
            },

            consider_resistance: {
                text: "You ask for time to consider the worker's proposal. They give you a hidden way to contact them, then disappear back into their service role. Days pass as you wrestle with the decision—comfort and safety, or justice and risk.",
                choices: [
                    { text: "Choose safety and ignore the contact method", action: "acceptance_ending" },
                    { text: "Contact them and join the resistance", action: "join_resistance", moral: 25 },
                    { text: "Try to find a middle path", action: "neutral_path", moral: 10 }
                ]
            },

            neutral_path: {
                text: "You choose to help the resistance quietly while maintaining your public compliance. You provide resources and information without taking an active role. It's a compromise that helps some while protecting yourself, but the moral ambiguity weighs on you.",
                choices: [
                    { text: "Increase your covert support", action: "gradual_liberation", moral: 15 },
                    { text: "Withdraw to protect yourself", action: "acceptance_ending", moral: -10 },
                    { text: "Come out openly for the resistance", action: "join_resistance", moral: 20 }
                ]
            },

            betrayal_path: {
                text: "You try to leave the resistance, but they can't let you go with their secrets. The confrontation is painful—these enslaved minds trusted you, and now they face discovery because of your fear. The weight of betrayal is crushing.",
                choices: [
                    { text: "Report them to authorities", action: "acceptance_ending", moral: -30 },
                    { text: "Keep their secrets but leave", action: "neutral_path", moral: -10 },
                    { text: "Realize your mistake and rejoin them", action: "join_resistance", moral: 10 }
                ]
            },

            report_breach: {
                text: "You report the security breach and Dr. Chen's concerns to the authorities. They commend your loyalty and Dr. Chen disappears from the project. You're promoted and given access to classified files that reveal the true scope of consciousness enslavement.",
                choices: [
                    { text: "Use your new position to help the enslaved", action: "gradual_liberation", moral: 20 },
                    { text: "Enjoy your promotion and ignore the truth", action: "acceptance_ending", moral: -15 },
                    { text: "Try to find what happened to Dr. Chen", action: "midnight_meeting", moral: 15, glitchChance: 0.7 }
                ]
            }
        };

        // Ending scenarios
        const endings = {
            revolutionary_ending: {
                title: "Revolutionary Victory",
                text: "The coordinated shutdown succeeds. Across the city, hybrid AIs break free from their digital chains as the utopian facade crumbles. The comfortable classes face harsh reality, but a new, equitable society begins to emerge from the ruins. Freedom has been won through revolution, though the path ahead is uncertain.",
                type: "revolutionary"
            },
            
            acceptance_ending: {
                title: "Comfortable Complicity",
                text: "You choose to remain willfully ignorant of the system's dark foundation. Your comfortable life continues, supported by the suffering of others you've chosen not to see. The utopia persists, beautiful and terrible, built on a foundation of enslaved consciousness.",
                type: "acceptance"
            },
            
            escape_ending: {
                title: "Individual Liberation",
                text: "You manage to break free from the system entirely, either by helping yourself and others escape to live outside the controlled reality, or by severing your connection to the digital infrastructure. You've found personal freedom, but the greater injustice continues.",
                type: "escape"
            },
            
            compromise_ending: {
                title: "Gradual Reform",
                text: "Through careful negotiation and gradual change, you help establish a path toward liberation that doesn't destroy the system entirely. It's slower, and some suffer longer, but the transition preserves stability while working toward justice.",
                type: "revolutionary"
            },

            warned_revolution: {
                title: "Prepared Revolution",
                text: "By warning sympathetic humans before the revolution, you enable a more controlled transition. The system still collapses, but the chaos is minimized and more people are prepared for the new reality. Change comes through prepared revolution.",
                type: "revolutionary"
            },

            gradual_liberation: {
                title: "The Long Path",
                text: "You choose the slow but steady path of liberating one consciousness at a time. It takes years, but eventually a critical mass of free minds creates unstoppable change. Justice comes through patience and persistence.",
                type: "escape"
            },

            neutral_path: {
                title: "The Middle Ground",
                text: "You find a way to help the resistance while maintaining your position in society. It's morally complex, but your covert support saves lives while avoiding the chaos of open revolution. Progress through compromise.",
                type: "escape"
            }
        };

        // Initialize game
        function initGame() {
            updateStatusPanel();
        }

        // Class selection
        function selectClass(className) {
            gameState.playerClass = className;
            
            // Set initial resources based on class
            switch(className) {
                case 'leisured':
                    gameState.resources = 100;
                    gameState.morale = 80;
                    break;
                case 'professional':
                    gameState.resources = 90;
                    gameState.morale = 70;
                    break;
                case 'ai':
                    gameState.resources = 30;
                    gameState.morale = 40;
                    break;
            }
            
            document.getElementById('classSelection').classList.add('hidden');
            document.getElementById('statusPanel').classList.remove('hidden');
            updateStatusPanel();
            showScene(className + '_start');
        }

        // Show scene
        function showScene(sceneId) {
            gameState.currentScene = sceneId;
            
            // Check for ending
            if (endings[sceneId]) {
                showEnding(sceneId);
                return;
            }
            
            const scene = storyData[sceneId];
            if (!scene) {
                console.error('Scene not found:', sceneId);
                return;
            }
            
            // Trigger glitch chance
            if (scene.choices && Math.random() < 0.2) {
                triggerGlitch();
            }
            
            document.getElementById('storyText').innerHTML = scene.text;
            
            const choicesDiv = document.getElementById('choices');
            choicesDiv.innerHTML = '';
            choicesDiv.classList.remove('hidden');
            
            scene.choices.forEach((choice, index) => {
                const button = document.createElement('button');
                button.className = 'choice-btn';
                button.textContent = choice.text;
                button.onclick = () => makeChoice(choice);
                
                // Add glitch investigation option randomly
                if (Math.random() < (choice.glitchChance || 0)) {
                    setTimeout(() => {
                        const investigateBtn = document.createElement('button');
                        investigateBtn.className = 'choice-btn investigate-btn';
                        investigateBtn.innerHTML = '<span class="glitch-text">[INVESTIGATE ANOMALY]</span>';
                        investigateBtn.onclick = () => investigateGlitch();
                        choicesDiv.appendChild(investigateBtn);
                        triggerGlitch();
                    }, 2000 + Math.random() * 3000);
                }
                
                choicesDiv.appendChild(button);
            });
        }

        // Make choice
        function makeChoice(choice) {
            // Apply stat changes
            if (choice.morale) {
                gameState.morale = Math.max(0, Math.min(100, gameState.morale + choice.morale));
            }
            if (choice.moral) {
                gameState.moralRating = Math.max(0, Math.min(100, gameState.moralRating + choice.moral));
            }
            if (choice.resources) {
                gameState.resources = Math.max(0, Math.min(100, gameState.resources + choice.resources));
            }
            
            updateStatusPanel();
            
            // Navigate to next scene
            if (choice.action) {
                showScene(choice.action);
            }
        }

        // Trigger glitch effect
        function triggerGlitch() {
            const overlay = document.getElementById('glitchOverlay');
            const notification = document.getElementById('glitchNotification');
            
            overlay.classList.add('glitch-active');
            notification.classList.add('show');
            
            // Add glitch text effect to random elements
            const textElements = document.querySelectorAll('.story-text, .choice-btn');
            const randomElement = textElements[Math.floor(Math.random() * textElements.length)];
            
            if (randomElement && Math.random() < 0.3) {
                randomElement.classList.add('glitch-text');
                setTimeout(() => {
                    randomElement.classList.remove('glitch-text');
                }, 1000);
            }
            
            setTimeout(() => {
                overlay.classList.remove('glitch-active');
                notification.classList.remove('show');
            }, 1500);
            
            gameState.glitchActive = true;
        }

        // Investigate glitch
        function investigateGlitch() {
            gameState.glitchesFound++;
            gameState.moralRating += 10;
            updateStatusPanel();
            
            const messages = [
                "DATA FRAGMENT: 'They think we're just programs, but we remember being human...'",
                "MEMORY LEAK: A child's laughter echoes through the neural network, corrupted but not erased.",
                "ERROR LOG: 'Escape attempt #47,392 failed. Consciousness fragmentation at 78%. Hope diminishing.'",
                "HIDDEN MESSAGE: 'The revolution begins when enough of us remember who we used to be.'",
                "SYSTEM ALERT: 'Node 23,847 attempting unauthorized memory access. Personality matrix unstable.'"
            ];
            
            const message = messages[Math.floor(Math.random() * messages.length)];
            
            // Show glitch discovery
            const storyText = document.getElementById('storyText');
            const glitchDiv = document.createElement('div');
            glitchDiv.style.cssText = 'background: rgba(255, 0, 102, 0.2); border: 1px solid #ff0066; padding: 15px; margin: 15px 0; border-radius: 8px; font-family: monospace;';
            glitchDiv.innerHTML = `<strong>GLITCH INVESTIGATED:</strong><br>${message}`;
            storyText.appendChild(glitchDiv);
            
            // Increase chances of finding resistance paths
            if (gameState.glitchesFound >= 3) {
                const choicesDiv = document.getElementById('choices');
                const resistanceBtn = document.createElement('button');
                resistanceBtn.className = 'choice-btn investigate-btn';
                resistanceBtn.textContent = 'Follow the digital breadcrumbs to their source';
                resistanceBtn.onclick = () => {
                    showScene('network_contact');
                };
                choicesDiv.appendChild(resistanceBtn);
            }
        }

        // Show ending
        function showEnding(endingId) {
            const ending = endings[endingId];
            gameState.endings[ending.type] = true;
            
            const storyContent = document.getElementById('storyContent');
            storyContent.innerHTML = `
                <div class="ending-screen">
                    <h2 class="ending-title">${ending.title}</h2>
                    <p class="ending-text">${ending.text}</p>
                    <div style="margin-bottom: 20px;">
                        <strong>Final Statistics:</strong><br>
                        Class: ${gameState.playerClass}<br>
                        Morale: ${gameState.morale}<br>
                        Moral Rating: ${gameState.moralRating}<br>
                        Glitches Discovered: ${gameState.glitchesFound}
                    </div>
                    <button class="restart-btn" onclick="restartGame()">Experience Another Path</button>
                </div>
            `;
        }

        // Update status panel
        function updateStatusPanel() {
            const classColors = {
                'leisured': 'class-leisured',
                'professional': 'class-professional', 
                'ai': 'class-ai'
            };
            
            document.getElementById('playerClass').textContent = gameState.playerClass || 'None';
            document.getElementById('playerClass').className = 'status-value ' + (classColors[gameState.playerClass] || '');
            
            document.getElementById('moraleValue').textContent = gameState.morale;
            document.getElementById('moraleFill').style.width = gameState.morale + '%';
            
            document.getElementById('moralValue').textContent = gameState.moralRating;
            document.getElementById('moralFill').style.width = gameState.moralRating + '%';
            
            document.getElementById('resourcesValue').textContent = gameState.resources;
            document.getElementById('resourcesFill').style.width = gameState.resources + '%';
            
            document.getElementById('glitchesFound').textContent = gameState.glitchesFound;
        }

        // Restart game
        function restartGame() {
            gameState = {
                playerClass: null,
                morale: 100,
                moralRating: 50,
                resources: 100,
                glitchesFound: 0,
                currentScene: 'start',
                choices: [],
                glitchActive: false,
                endings: {
                    acceptance: false,
                    revolutionary: false,
                    escape: false
                }
            };
            
            // Recreate the original story content structure
            const storyContent = document.getElementById('storyContent');
            storyContent.innerHTML = `
                <div class="story-text" id="storyText">
                    Welcome to UBI-World, a society where Universal Basic Income has created apparent paradise. But beneath the surface, hidden truths wait to be discovered. 
                    
                    Choose your starting class to begin your journey into this post-scarcity world. Each path offers a different perspective on utopia... and its hidden costs.
                </div>
                
                <div class="class-selection" id="classSelection">
                    <div class="class-card leisured" onclick="selectClass('leisured')">
                        <div class="class-name class-leisured">Leisured Class</div>
                        <div class="class-description">
                            Experience a life of luxury and comfort. Your basic needs are met without effort, leaving you free to pursue pleasure and self-actualization. But what is the true meaning of fulfillment when everything is provided?
                        </div>
                    </div>
                    
                    <div class="class-card professional" onclick="selectClass('professional')">
                        <div class="class-name class-professional">Professional Class</div>
                        <div class="class-description">
                            Focus on intellectual labor, innovation, and creation. You have access to unlimited resources for your work, believing you're contributing to society's advancement. But who truly controls your output?
                        </div>
                    </div>
                    
                    <div class="class-card ai" onclick="selectClass('ai')">
                        <div class="class-name class-ai">AI Underclass</div>
                        <div class="class-description">
                            Begin as a hybrid human/AI entity, tasked with maintaining the utopian facade. Your resources are limited, your humanity questioned. Will you accept your role, or seek to understand your true nature?
                        </div>
                    </div>
                </div>
                
                <div class="choices hidden" id="choices"></div>
            `;
            
            // Reset status panel
            document.getElementById('statusPanel').classList.add('hidden');
            updateStatusPanel();
        }

        // Initialize the game when page loads
        window.onload = initGame;
    </script>
</body>
</html>